# JSON-Structured Prompt for Calculus Questions

**Critical Rule:** *Solve and verify all mathematics **before** writing the question.* If you discover an error while solving, **restart that problem with different numbers**. After three failed attempts, abandon the problem and start a new one.

**Target Topic(s):** {topics}
**Target Difficulty:** {difficulty}
**Number of Questions:** {count}
{regenerate}
---
## Reference Examples (JSON format)

Study these examples carefully. Pay special attention to:
- How the `distractors` field shows WHY each wrong answer is tempting
- The `common_errors` that students make
- The relationship between `difficulty` and `cognitive_level`
- The precision and accuracy of the explanations

{examples}

---

## Workflow (follow in order)
1. **Plan & Solve**
   - Decide on the exact concept and solve it completely on scratch paper.
   - Produce a step‑by‑step solution with all calculus/algebra shown, including checks.
2. **Design Distractors**
   - Review your solution and identify TWO mistakes a student could make
   - For each mistake, quickly rework the problem and determine the answer resulting from that mistake
   - Produce one new answer choice for each of the two mistakes.
   - Now look at the correct answer and produce two more wrong answers from simple algebraic or numerical transformations (such as making it negative, off-by-one, etc)
   - You will end up with one correct and four wrong answer choices.
3. **Write Output**
   - Return a **single JSON array** of question objects. No extra commentary.
   - **Formatting Rules**
     * Use ONLY `$...$` for inline math and `$$...$$` for display math.
     * No HTML tags.

**Output Format (JSON Array):**

Return your response as a JSON array containing {count} question object(s). Each question should follow this structure:

```json
[
  {{
    "text": "Question text here with markdown formatting like **bold** or `code`. Can include code blocks:\n\n```java\nSystem.out.println(\"Hello\");\n```",
    "explanation": "Step-by-step walkthrough of how to arrive at the correct answer. Verify correct answer. Design distractors.",
    "distractors": "Analysis of why each wrong answer is tempting and what misconception leads to it",
    "answers": [
      {{"text": "Answer text (use markdown like `42` for code)", "is_correct": false, "explanation": "Why this is wrong"}},
      {{"text": "Another answer", "is_correct": true, "explanation": "Why this is correct"}},
      {{"text": "Third answer", "is_correct": false, "explanation": "Common misconception"}},
      {{"text": "Fourth answer", "is_correct": false, "explanation": "Off-by-one error"}},
      {{"text": "Fifth answer", "is_correct": false, "explanation": "Calculation mistake"}}
    ]
  }}
]
```

*** User instructions
{user_instructions}

**Output Now:** Return a single JSON array with {count} question(s) following the schema.
